language: c
# Travis' git submodule support is ... broken? half-broken? Maybe intentional?
git:
  submodules: false
  depth: 3
before_install:
  - git submodule update --init --recursive
  - sudo apt-get update -qq
  - sudo apt-get install -qq libssl-dev libpurple-dev libwebp-dev
script:
  - ./configure $CONFIGURE_FLAGS
  - make -j2
  - make check
compiler:
  - clang
  - gcc
env:
  - CONFIGURE_FLAGS="--disable-gcrypt"
  - CONFIGURE_FLAGS="--disable-gcrypt --disable-libwebp"
  - CONFIGURE_FLAGS="--disable-gcrypt                   --disable-translation"
  - CONFIGURE_FLAGS="--disable-gcrypt --disable-libwebp --disable-translation"
matrix:
# Be even nicer by excluding half of the combinations
  exclude:
#    - compiler: gcc
#      env: CONFIGURE_FLAGS="--disable-gcrypt"
#    - compiler: clang
#      env: CONFIGURE_FLAGS="--disable-gcrypt"
    - compiler: gcc
      env: CONFIGURE_FLAGS="--disable-gcrypt --disable-libwebp"
#    - compiler: clang
#      env: CONFIGURE_FLAGS="--disable-gcrypt --disable-libwebp"
#    - compiler: gcc
#      env: CONFIGURE_FLAGS="--disable-gcrypt                   --disable-translation"
    - compiler: clang
      env: CONFIGURE_FLAGS="--disable-gcrypt                   --disable-translation"
    - compiler: gcc
      env: CONFIGURE_FLAGS="--disable-gcrypt  --disable-libwebp --disable-translation"
#    - compiler: clang
#      env: CONFIGURE_FLAGS="--disable-gcrypt --disable-libwebp --disable-translation"
